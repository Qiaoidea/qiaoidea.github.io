
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
    <title>UI--微博（动态）点赞，简单效果中的不简单门道 | Qiaoidea&#39;s Blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="Qiaoidea">
    
    <meta name="description" content="《代码里的世界》  —-UI篇

用文字札记描绘自己 android学习之路
转载请保留出处 by Qiaohttp://blog.csdn.net/qiaoidea/article/details/45850641

【导航】

单行文本水平触摸滑动效果   通过EditText实现TextView单行长文本水平滑动效果
多行文本折叠展开    自定义布局View实现多行文本折叠和展开


1.概述
　　说起空间动态、微博的点赞效果，网上也是很泛滥，各种实现与效果一大堆。而详细实现的部分，讲述的也是参差不齐，另一方面估计也有很多大侠也不屑一顾，觉得完全没必要单独开篇来写和讲解吧。毕竟，也就是两个view和一些简单的动画效果罢了。　　单若是只讲这些，我自然也是不愿花这番功夫的。虽然自己很菜，可也不甘于太菜。所以偶尔看到些好东西，可以延伸学写下，我还是很情愿拿出来用用，顺带秀一秀逼格什么的。　　不扯太多，先说说今天实现点赞效果用到的自以为不错的两个点：

Checkable  用来扩展View实现选中状态切换
AndroidViewAnimations  基于nineoldandroids封装的android动画简易类库。究竟有多简单呢，就像这样
AnimHelper.with(new PulseAnimator()).duration(1000).playOn(imageView); 作用： 在imageView上使用PulseAnimator这个动画效果，播放一秒。



　　当然是从实现角度来看这个库啦，如果仅仅是使用，google/百度一大堆啦。　　结合前两篇富文本折叠展开，加上我们的点赞view 做出的demo整合效果图：">
    
    
    
    
    <link rel="alternative" href="/atom.xml" title="Qiaoidea&#39;s Blog" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css" type="text/css">

</head>

  <body>
    <header>
      <div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="Qiaoidea&#39;s Blog" title="Qiaoidea&#39;s Blog"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="Qiaoidea&#39;s Blog">Qiaoidea&#39;s Blog</a></h1>
				<h2 class="blog-motto">你必须非常努力，才能看起来毫不费力。</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">主页</a></li>
					
						<li><a href="/programing_art">编程艺术</a></li>
					
						<li><a href="/archives">归档</a></li>
					
						<li><a href="/dj">札记</a></li>
					
						<li><a href="/about">关于</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:qiaoidea.github.io">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/04/30/android_note/UI--微博（动态）点赞，简单效果中的不简单门道/" title="UI--微博（动态）点赞，简单效果中的不简单门道" itemprop="url">UI--微博（动态）点赞，简单效果中的不简单门道</a>
  </h1>
  <p class="article-author">By
       
		<a href="http://qiaoidea.github.io/about" title="Qiaoidea" target="_blank" itemprop="author">Qiaoidea</a>
		
  <p class="article-time">
    <time datetime="2015-04-29T16:00:00.000Z" itemprop="datePublished"> 发表于 4月 30 2015</time>
    
  </p>
</header>
	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		
			<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#《代码里的世界》_—-UI篇"><span class="toc-number">1.</span> <span class="toc-text">《代码里的世界》  —-UI篇</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-概述"><span class="toc-number">2.</span> <span class="toc-text">1.概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">3.</span> <span class="toc-text"></span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-从实现看门道"><span class="toc-number">4.</span> <span class="toc-text">2.从实现看门道</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1_Checkable接口实现CheckedImageView"><span class="toc-number">4.1.</span> <span class="toc-text">2.1 Checkable接口实现CheckedImageView</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2_动画库的封装和快速框架"><span class="toc-number">4.2.</span> <span class="toc-text">2.2 动画库的封装和快速框架</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-_首先定义一个基本动画效果类BaseViewAnimator"><span class="toc-number">4.2.1.</span> <span class="toc-text">1. 首先定义一个基本动画效果类BaseViewAnimator</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-_其次基于这个类实现我们的各种动画效果XXAnimator"><span class="toc-number">4.2.2.</span> <span class="toc-text">2. 其次基于这个类实现我们的各种动画效果XXAnimator</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-_最后封装一个动画管理工具类AnimHelper供外部使用"><span class="toc-number">4.2.3.</span> <span class="toc-text">3. 最后封装一个动画管理工具类AnimHelper供外部使用</span></a></li></ol></li></ol></li></ol>
		
		</div>
		
		<h2 id="《代码里的世界》_—-UI篇"><strong>《代码里的世界》</strong>  —-<strong><em>UI篇</em></strong></h2>
<blockquote>
<p>用文字札记描绘自己 android学习之路</p>
<p><em>转载请保留出处 by Qiao</em><br><a href="http://blog.csdn.net/qiaoidea/article/details/45850641" target="_blank" rel="external">http://blog.csdn.net/qiaoidea/article/details/45850641</a></p>
</blockquote>
<p><strong>【导航】</strong></p>
<ul>
<li><a href="https://github.com/JakeWharton/NineOldAndroids" target="_blank" rel="external">单行文本水平触摸滑动效果</a>   通过EditText实现TextView单行长文本水平滑动效果</li>
<li><a href="https://github.com/daimajia/AndroidViewAnimations" target="_blank" rel="external">多行文本折叠展开</a>    自定义布局View实现多行文本折叠和展开</li>
</ul>
<hr>
<h2 id="1-概述"><strong>1.概述</strong></h2>
<p>　　说起空间动态、微博的点赞效果，网上也是很泛滥，各种实现与效果一大堆。而详细实现的部分，讲述的也是参差不齐，另一方面估计也有很多大侠也不屑一顾，觉得完全没必要单独开篇来写和讲解吧。毕竟，也就是两个view和一些简单的动画效果罢了。<br>　　单若是只讲这些，我自然也是不愿花这番功夫的。虽然自己很菜，可也不甘于太菜。所以偶尔看到些好东西，可以延伸学写下，我还是很情愿拿出来用用，顺带秀一秀逼格什么的。<br>　　不扯太多，先说说今天实现点赞效果用到的自以为不错的两个点：</p>
<ul>
<li><strong>Checkable</strong>  用来扩展View实现选中状态切换</li>
<li><strong>AndroidViewAnimations</strong>  基于nineoldandroids封装的android动画简易类库。究竟有多简单呢，就像这样<blockquote>
<p>AnimHelper.with(new PulseAnimator()).duration(1000).playOn(imageView);<br> 作用： <em>在imageView上使用PulseAnimator这个动画效果，播放一秒。</em></p>
</blockquote>
</li>
</ul>
<p>　　当然是从实现角度来看这个库啦，如果仅仅是使用，google/百度一大堆啦。<br>　　<br>结合前两篇富文本折叠展开，加上我们的点赞view <strong>做出的demo整合效果图：</strong><br><img src="http://img.blog.csdn.net/20150519222450167" alt="点赞效果"></p>
<h2><a id="more"></a></h2>
<h2 id="2-从实现看门道"><strong>2.从实现看门道</strong></h2>
<p>　　其实从效果看无非就是点击切换图片，并添加一些简单动画效果而已，确实没什么难度。这里是因为引入了两个不错的新内容，使用下，权当新手尝鲜。</p>
<h3 id="2-1_Checkable接口实现CheckedImageView">2.1 Checkable接口实现<strong>CheckedImageView</strong></h3>
<p>　　系统本身提供了android.widget.Checkable这样一个接口，方便我们继承实现View的选中和取消的状态。看下这个类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Checkable</span> </span>{</div><div class="line">    </div><div class="line">    <span class="javadoc">/**</span></div><div class="line">     * 设置view的选中状态</div><div class="line">     */</div><div class="line">    <span class="keyword">void</span> setChecked(<span class="keyword">boolean</span> checked);</div><div class="line">        </div><div class="line">    <span class="javadoc">/**</span></div><div class="line">     * 当前view是否被选中</div><div class="line">     */</div><div class="line">    <span class="keyword">boolean</span> isChecked();</div><div class="line">    </div><div class="line">    <span class="javadoc">/**</span></div><div class="line">     *改变view的选中状态到相反的状态</div><div class="line">     */</div><div class="line">    <span class="keyword">void</span> toggle();</div><div class="line">}</div></pre></td></tr></table></figure>

<p>　　通常这个接口用来帮助我们快速实现view的可选效果，增加了选中和取消两种状态和切换方法。另外为了方便View在状态改变时候快速地变看到效果（更背景或图片)，我们可以直接通过selector控制图片，而其本身并不会自动改变drawable状态，因此这里还有必要重写drawableStateChanged<br>方法。我们先以定义一个通用的CheckedImageView为例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CheckedImageView</span> <span class="keyword">extends</span> <span class="title">ImageView</span> <span class="keyword">implements</span> <span class="title">Checkable</span></span>{</div><div class="line">	<span class="keyword">protected</span> <span class="keyword">boolean</span> isChecked;<span class="comment">//选中状态</span></div><div class="line">	<span class="keyword">protected</span> OnCheckedChangeListener onCheckedChangeListener;<span class="comment">//状态改变事件监听</span></div><div class="line">	</div><div class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span>[] CHECKED_STATE_SET = { android.R.attr.state_checked };</div><div class="line">	</div><div class="line">	<span class="keyword">public</span> <span class="title">CheckedImageView</span>(Context context) {</div><div class="line">		<span class="keyword">super</span>(context);</div><div class="line">		initialize();</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="keyword">public</span> <span class="title">CheckedImageView</span>(Context context, AttributeSet attrs) {</div><div class="line">		<span class="keyword">super</span>(context, attrs);</div><div class="line">		initialize();</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initialize</span>() {</div><div class="line">		isChecked = <span class="keyword">false</span>;</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="annotation">@Override</span></div><div class="line">	<span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isChecked</span>() {</div><div class="line">		<span class="keyword">return</span> isChecked;</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="annotation">@Override</span></div><div class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setChecked</span>(<span class="keyword">boolean</span> isChecked) {</div><div class="line">		<span class="keyword">if</span> (<span class="keyword">this</span>.isChecked != isChecked) {</div><div class="line">			<span class="keyword">this</span>.isChecked = isChecked;</div><div class="line">			refreshDrawableState();</div><div class="line">			</div><div class="line">			<span class="keyword">if</span> (onCheckedChangeListener != <span class="keyword">null</span>) {</div><div class="line">				onCheckedChangeListener.onCheckedChanged(<span class="keyword">this</span>, isChecked);</div><div class="line">			}</div><div class="line">		}</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="annotation">@Override</span></div><div class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">toggle</span>() {<span class="comment">//改变状态</span></div><div class="line">		setChecked(!isChecked);</div><div class="line">	}</div><div class="line">	</div><div class="line">	<span class="comment">//初始DrawableState时候为它添加一个CHECKED_STATE，ImageView本身是没有这个状态的</span></div><div class="line">	<span class="annotation">@Override</span></div><div class="line">	<span class="keyword">public</span> <span class="keyword">int</span>[] <span class="title">onCreateDrawableState</span>(<span class="keyword">int</span> extraSpace) {</div><div class="line">		<span class="keyword">int</span>[] states = <span class="keyword">super</span>.onCreateDrawableState(extraSpace + <span class="number">1</span>);</div><div class="line">		<span class="keyword">if</span> (isChecked()) {</div><div class="line">			mergeDrawableStates(states, CHECKED_STATE_SET);</div><div class="line">		}</div><div class="line">		<span class="keyword">return</span> states;</div><div class="line">	}</div><div class="line">	</div><div class="line">	<span class="comment">//当view的选中状态被改变的时候通知ImageView改变背景或内容，这个view会自动在drawable状态集中选择与当前状态匹配的图片</span></div><div class="line">	<span class="annotation">@Override</span></div><div class="line">	<span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">drawableStateChanged</span>() {</div><div class="line">		<span class="keyword">super</span>.drawableStateChanged();</div><div class="line">		Drawable drawable = getDrawable();</div><div class="line">		<span class="keyword">if</span> (drawable != <span class="keyword">null</span>) {</div><div class="line">			<span class="keyword">int</span>[] myDrawableState = getDrawableState();</div><div class="line">			drawable.setState(myDrawableState);</div><div class="line">			invalidate();</div><div class="line">		}</div><div class="line">	}</div><div class="line">	</div><div class="line">	<span class="comment">//设置状态改变监听事件</span></div><div class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOnCheckedChangeListener</span>(OnCheckedChangeListener onCheckedChangeListener) {</div><div class="line">		<span class="keyword">this</span>.onCheckedChangeListener = onCheckedChangeListener;</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="comment">//当选中状态改变时监听接口触发该事件</span></div><div class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">interface</span> <span class="title">OnCheckedChangeListener</span> </span>{</div><div class="line">		<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCheckedChanged</span>(CheckedImageView checkedImgeView, <span class="keyword">boolean</span> isChecked);</div><div class="line">	}</div><div class="line">}</div></pre></td></tr></table></figure>

<p>　　这是一个通用的可被选中ImageView,当点击之后被选中，再次点击则取消。而其背景/内容也会随之改变。比如下图所示效果：<br>　　<img src="http://img.blog.csdn.net/20150520151443213" alt="可被选中图片"><br>　　<br>　　从代码上看，我们本身并没有直接定义当view点击之后,调用setImage()或者setBackground()来改变内容，而是通过使用View本身的DrawableState来绘制和更改，查找与它对应匹配的图片，而这些状态所对应的图片，都预先在selector中配置好。关于selector这里不做介绍，自行查阅学习。<br>　　<br>　　既然提到selector,<em>顺带提下之前遇到的坑，关于他的匹配原则。比如下边这样一个selector：</em></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</div><div class="line">&lt;selector xmlns:android="http://schemas.android.com/apk/res/android"&gt;</div><div class="line">    &lt;item android:state_pressed="true" android:drawable="@drawable/icon_pressed"&gt;&lt;/item&gt;</div><div class="line">    &lt;item android:state_checked="true" android:drawable="@drawable/icon_checked"&gt;&lt;/item&gt;</div><div class="line">    &lt;item android:drawable="@drawable/icon_normal"&gt;&lt;/item&gt;</div><div class="line">&lt;/selector&gt;</div></pre></td></tr></table></figure>

<p>　　当view同时有上边两个状态(如state_pressed和state_checked)的时候，view优先显示第一个状态时候的图片（icon_pressed）。这是因为它是由上到下有序查找的，当找到第一个状态与他定义的所相符所在行时，就优先显示这行的图片。所以当我们将最后一行</p>
<blockquote>
<p>&lt; item android:drawable=”@drawable/icon_normal”&gt;&lt; /item&gt;</p>
</blockquote>
<p>放在第一行时，无论是否选中状态或按下状态，都显示的是icon_normal。初学者一定要注意，我当初就因为这个原因耗费了很多时间查找缘由。</p>
<p>　　回到我们的点赞实现。这里实现的点赞View <strong>PraiseView</strong> 包含了一个 CheckedImageView 和一个 TextView ,点赞之后，ImageView会放大回缩并弹出一个TextView”+1”的动画效果。 </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PraiseView</span> <span class="keyword">extends</span> <span class="title">FrameLayout</span> <span class="keyword">implements</span> <span class="title">Checkable</span></span>{<span class="comment">//同样继承Checkable</span></div><div class="line">	<span class="keyword">protected</span> OnPraisCheckedListener praiseCheckedListener;</div><div class="line">	<span class="keyword">protected</span> CheckedImageView imageView; <span class="comment">//点赞图片</span></div><div class="line">	<span class="keyword">protected</span> TextView textView; <span class="comment">//+1</span></div><div class="line">	<span class="keyword">protected</span> <span class="keyword">int</span> padding;</div><div class="line"></div><div class="line">	<span class="keyword">public</span> <span class="title">PraiseView</span>(Context context) {</div><div class="line">		<span class="keyword">super</span>(context);</div><div class="line">		initalize();</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="keyword">public</span> <span class="title">PraiseView</span>(Context context, AttributeSet attrs) {</div><div class="line">		<span class="keyword">super</span>(context, attrs);</div><div class="line">		initalize();</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">initalize</span>() {</div><div class="line">		setClickable(<span class="keyword">true</span>);</div><div class="line">		imageView = <span class="keyword">new</span> CheckedImageView(getContext());</div><div class="line">		imageView.setImageResource(R.drawable.blog_praise_selector);</div><div class="line">		FrameLayout.LayoutParams flp = <span class="keyword">new</span> LayoutParams(FrameLayout.LayoutParams.WRAP_CONTENT, FrameLayout.LayoutParams.WRAP_CONTENT,Gravity.CENTER);</div><div class="line">		addView(imageView, flp);</div><div class="line"></div><div class="line">		textView = <span class="keyword">new</span> TextView(getContext());</div><div class="line">		textView.setTextSize(<span class="number">10</span>);</div><div class="line">		textView.setText(<span class="string">"+1"</span>);</div><div class="line">		textView.setTextColor(Color.parseColor(<span class="string">"#A24040"</span>));</div><div class="line">		textView.setGravity(Gravity.CENTER);</div><div class="line">		addView(textView, flp);</div><div class="line">		textView.setVisibility(View.GONE);</div><div class="line">	}</div><div class="line">	</div><div class="line">	<span class="annotation">@Override</span></div><div class="line">	<span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">performClick</span>() {</div><div class="line">		checkChange();</div><div class="line">		<span class="keyword">return</span> <span class="keyword">super</span>.performClick();</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="annotation">@Override</span></div><div class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">toggle</span>() {</div><div class="line">		checkChange();</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setChecked</span>(<span class="keyword">boolean</span> isCheacked) {</div><div class="line">		imageView.setChecked(isCheacked);</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">checkChange</span>() {<span class="comment">//点击切换状态</span></div><div class="line">		<span class="keyword">if</span> (imageView.isChecked) {</div><div class="line">			imageView.setChecked(<span class="keyword">false</span>);</div><div class="line">		} <span class="keyword">else</span> {</div><div class="line">			imageView.setChecked(<span class="keyword">true</span>);</div><div class="line">			textView.setVisibility(View.VISIBLE);</div><div class="line">			<span class="comment">//放大动画</span></div><div class="line">			AnimHelper.with(<span class="keyword">new</span> PulseAnimator()).duration(<span class="number">1000</span>).playOn(imageView);</div><div class="line">			<span class="comment">//飘 “+1”动画</span></div><div class="line">			AnimHelper.with(<span class="keyword">new</span> SlideOutUpAnimator()).duration(<span class="number">1000</span>).playOn(textView);</div><div class="line">		}</div><div class="line">		<span class="comment">//调用点赞事件</span></div><div class="line">		<span class="keyword">if</span> (praiseCheckedListener != <span class="keyword">null</span>) {</div><div class="line">			praiseCheckedListener.onPraisChecked(imageView.isChecked);</div><div class="line">		}</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isChecked</span>() {</div><div class="line">		<span class="keyword">return</span> imageView.isChecked;</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOnPraisCheckedListener</span>(OnPraisCheckedListener praiseCheckedListener) {</div><div class="line">		<span class="keyword">this</span>.praiseCheckedListener = praiseCheckedListener;</div><div class="line">	}</div><div class="line">	</div><div class="line">	<span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">OnPraisCheckedListener</span></span>{</div><div class="line">		<span class="keyword">void</span> onPraisChecked(<span class="keyword">boolean</span> isChecked);</div><div class="line">	}</div><div class="line">}</div></pre></td></tr></table></figure>

<p>　　过于自定的View大概就这么多了，Checkable这个小巧方便的类，不知道你会用了没。至于上边用到的两个动画效果集：</p>
<blockquote>
<p>AnimHelper.with(new PulseAnimator()).duration(1000).playOn(imageView);<br>AnimHelper.with(new SlideOutUpAnimator()).duration(1000).playOn(textView);</p>
</blockquote>
<p>感觉封装的挺简洁实用，所以很有必要学习分析一下。</p>
<h3 id="2-2_动画库的封装和快速框架">2.2 <strong>动画库的封装和快速框架</strong></h3>
<p>　　提到动画，Android本身自带的动画类Animation已经做到支持3.0及以上了，虽然也做了很好的封装，但是做起复杂动画来还是不够像上边那样简洁。在关于动画兼容方面，github上的大牛Jake Wharton又做了一套动画开源库<a href="https://github.com/JakeWharton/NineOldAndroids" target="_blank" rel="external">NineOldAndroids</a>，效果很好而且支持3.0级以前的版本，确实很值得称赞。而在此基础上，有很多高手又做了二次封装，实现了复杂动画，同时保证方便简洁，而且通用性和扩展性更高。我们这里的动画使用的就是这样一个简单的封装。<br>　　比如，要在XXView上时用XXAnimator这样的动画，持续Duration秒。就这么一行代码：</p>
<blockquote>
<p>AnimHelper.with(new SlideOutUpAnimator()).duration(1000).playOn(textView);</p>
</blockquote>
<p>　　来看一下基于NineOldAndroids的ViewAnimations具体实现。</p>
<h4 id="1-_首先定义一个基本动画效果类BaseViewAnimator">1. <strong>首先定义一个基本动画效果类BaseViewAnimator</strong></h4>
<p>　　这个BaseViewAnimator动画类使用一个动画集合AnimatorSet，包装成单个动画类似的用法，并定义了一个abstract方法prepare()：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseViewAnimator</span> </span>{</div><div class="line"></div><div class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> DURATION = <span class="number">1000</span>;</div><div class="line"></div><div class="line">	<span class="keyword">private</span> AnimatorSet mAnimatorSet;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">long</span> mDuration = DURATION;</div><div class="line"></div><div class="line">	{</div><div class="line">		mAnimatorSet = <span class="keyword">new</span> AnimatorSet();</div><div class="line">	}</div><div class="line"></div><div class="line"></div><div class="line">	<span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">prepare</span>(View target);</div><div class="line"></div><div class="line">	<span class="keyword">public</span> BaseViewAnimator <span class="title">setTarget</span>(View target) {</div><div class="line">		reset(target);</div><div class="line">		prepare(target);</div><div class="line">		<span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">animate</span>() {</div><div class="line">		start();</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="javadoc">/**</span></div><div class="line">	 * reset the view to default status</div><div class="line">	 *</div><div class="line">	 *<span class="javadoctag"> @param</span> target</div><div class="line">	 */</div><div class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reset</span>(View target) {</div><div class="line">		ViewHelper.setAlpha(target, <span class="number">1</span>);</div><div class="line">		ViewHelper.setScaleX(target, <span class="number">1</span>);</div><div class="line">		ViewHelper.setScaleY(target, <span class="number">1</span>);</div><div class="line">		ViewHelper.setTranslationX(target, <span class="number">0</span>);</div><div class="line">		ViewHelper.setTranslationY(target, <span class="number">0</span>);</div><div class="line">		ViewHelper.setRotation(target, <span class="number">0</span>);</div><div class="line">		ViewHelper.setRotationY(target, <span class="number">0</span>);</div><div class="line">		ViewHelper.setRotationX(target, <span class="number">0</span>);</div><div class="line">		ViewHelper.setPivotX(target, target.getMeasuredWidth() / <span class="number">2.0</span>f);</div><div class="line">		ViewHelper.setPivotY(target, target.getMeasuredHeight() / <span class="number">2.0</span>f);</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="javadoc">/**</span></div><div class="line">	 * start to animate</div><div class="line">	 */</div><div class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">start</span>() {</div><div class="line">		mAnimatorSet.setDuration(mDuration);</div><div class="line">		mAnimatorSet.start();</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="keyword">public</span> BaseViewAnimator <span class="title">setDuration</span>(<span class="keyword">long</span> duration) {</div><div class="line">		mDuration = duration;</div><div class="line">		<span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="keyword">public</span> BaseViewAnimator <span class="title">setStartDelay</span>(<span class="keyword">long</span> delay) {</div><div class="line">		getAnimatorAgent().setStartDelay(delay);</div><div class="line">		<span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getStartDelay</span>() {</div><div class="line">		<span class="keyword">return</span> mAnimatorSet.getStartDelay();</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="keyword">public</span> BaseViewAnimator <span class="title">addAnimatorListener</span>(AnimatorListener l) {</div><div class="line">		mAnimatorSet.addListener(l);</div><div class="line">		<span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">cancel</span>(){</div><div class="line">		mAnimatorSet.cancel();</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isRunning</span>(){</div><div class="line">		<span class="keyword">return</span> mAnimatorSet.isRunning();</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isStarted</span>(){</div><div class="line">		<span class="keyword">return</span> mAnimatorSet.isStarted();</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">removeAnimatorListener</span>(AnimatorListener l) {</div><div class="line">		mAnimatorSet.removeListener(l);</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">removeAllListener</span>() {</div><div class="line">		mAnimatorSet.removeAllListeners();</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="keyword">public</span> BaseViewAnimator <span class="title">setInterpolator</span>(Interpolator interpolator) {</div><div class="line">		mAnimatorSet.setInterpolator(interpolator);</div><div class="line">		<span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getDuration</span>() {</div><div class="line">		<span class="keyword">return</span> mDuration;</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="keyword">public</span> AnimatorSet <span class="title">getAnimatorAgent</span>() {</div><div class="line">		<span class="keyword">return</span> mAnimatorSet;</div><div class="line">	}</div><div class="line"></div><div class="line">}</div></pre></td></tr></table></figure>

<p> 　　复杂动画效果基类BaseViewAnimator使用一个AnimatorSet集合来添加各种动画 ,并绑定到目标targetView ,使用 <strong>prepare(View target)</strong> 的abstract方法供其子类实现具体的动画效果。 
　　</p>
<h4 id="2-_其次基于这个类实现我们的各种动画效果XXAnimator">2. <strong>其次基于这个类实现我们的各种动画效果XXAnimator</strong></h4>
<p> 　当我们要实现具体的动画效果时，可以直接继承这个类并实现prepaer方法。比如这里定义的上划消失SlideOutUpAnimator 和放大回缩动画PulseAnimator</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="javadoc">/**</span></div><div class="line">*上划消失（飘+1）</div><div class="line">*/</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SlideOutUpAnimator</span> <span class="keyword">extends</span> <span class="title">BaseViewAnimator</span> </span>{</div><div class="line">    <span class="annotation">@Override</span></div><div class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">prepare</span>(View target) {</div><div class="line">        ViewGroup parent = (ViewGroup)target.getParent();</div><div class="line">        getAnimatorAgent().playTogether(</div><div class="line">                ObjectAnimator.ofFloat(target, <span class="string">"alpha"</span>, <span class="number">1</span>, <span class="number">0</span>),</div><div class="line">                ObjectAnimator.ofFloat(target,<span class="string">"translationY"</span>,<span class="number">0</span>,-parent.getHeight()/<span class="number">2</span>)</div><div class="line">        );</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="javadoc">/**</span></div><div class="line">*放大效果</div><div class="line">*/</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PulseAnimator</span> <span class="keyword">extends</span> <span class="title">BaseViewAnimator</span> </span>{</div><div class="line">    <span class="annotation">@Override</span></div><div class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">prepare</span>(View target) {</div><div class="line">        getAnimatorAgent().playTogether(</div><div class="line">                ObjectAnimator.ofFloat(target, <span class="string">"scaleY"</span>, <span class="number">1</span>, <span class="number">1.2</span>f, <span class="number">1</span>),</div><div class="line">                ObjectAnimator.ofFloat(target, <span class="string">"scaleX"</span>, <span class="number">1</span>, <span class="number">1.2</span>f, <span class="number">1</span>)</div><div class="line">        );</div><div class="line">    }</div><div class="line">}</div></pre></td></tr></table></figure>

<p> 　上边两种动画效果就是对BaseViewAnimator的两种实现，动画本身使用的库是NineOldAndroids。</p>
<h4 id="3-_最后封装一个动画管理工具类AnimHelper供外部使用">3. <strong>最后封装一个动画管理工具类AnimHelper供外部使用</strong></h4>
<p> 　首先定义了一个静态类，使用helper来实例化这个静态类，并设置各个参数选项。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AnimHelper</span> </span>{</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> DURATION = BaseViewAnimator.DURATION;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> NO_DELAY = <span class="number">0</span>;</div><div class="line"></div><div class="line">	<span class="javadoc">/**</span></div><div class="line">	*实例化得到AnimationComposer的唯一接口</div><div class="line">	*/</div><div class="line">	<span class="keyword">public</span> <span class="keyword">static</span> AnimationComposer <span class="title">with</span>(BaseViewAnimator animator) {</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> AnimationComposer(animator);</div><div class="line">    }</div><div class="line"></div><div class="line">	<span class="javadoc">/**</span></div><div class="line">	*定义与动画效果相关联的各种参数，</div><div class="line">	*使用这种方法可以保证对象的构建和他的表示相互隔离开来</div><div class="line">	*/</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">AnimationComposer</span> </span>{</div><div class="line"></div><div class="line">        <span class="keyword">private</span> List&lt;Animator.AnimatorListener&gt; callbacks = <span class="keyword">new</span> ArrayList&lt;Animator.AnimatorListener&gt;();</div><div class="line"></div><div class="line">        <span class="keyword">private</span> BaseViewAnimator animator;</div><div class="line">        <span class="keyword">private</span> <span class="keyword">long</span> duration = DURATION;</div><div class="line">        <span class="keyword">private</span> <span class="keyword">long</span> delay = NO_DELAY;</div><div class="line">        <span class="keyword">private</span> Interpolator interpolator;</div><div class="line">        <span class="keyword">private</span> View target;</div><div class="line"></div><div class="line">        <span class="keyword">private</span> <span class="title">AnimationComposer</span>(BaseViewAnimator animator) {</div><div class="line">            <span class="keyword">this</span>.animator = animator;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="keyword">public</span> AnimationComposer <span class="title">duration</span>(<span class="keyword">long</span> duration) {</div><div class="line">            <span class="keyword">this</span>.duration = duration;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="keyword">public</span> AnimationComposer <span class="title">delay</span>(<span class="keyword">long</span> delay) {</div><div class="line">            <span class="keyword">this</span>.delay = delay;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="keyword">public</span> AnimationComposer <span class="title">interpolate</span>(Interpolator interpolator) {</div><div class="line">            <span class="keyword">this</span>.interpolator = interpolator;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">        }</div><div class="line"></div><div class="line"></div><div class="line">        <span class="keyword">public</span> AnimationComposer <span class="title">withListener</span>(Animator.AnimatorListener listener) {</div><div class="line">            callbacks.add(listener);</div><div class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="keyword">public</span> AnimManager <span class="title">playOn</span>(View target) {</div><div class="line">            <span class="keyword">this</span>.target = target;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">new</span> AnimManager(play(), <span class="keyword">this</span>.target);</div><div class="line">        }</div><div class="line">        </div><div class="line">        <span class="keyword">private</span> BaseViewAnimator <span class="title">play</span>() {</div><div class="line">            animator.setTarget(target);</div><div class="line">            animator.setDuration(duration)</div><div class="line">                    .setInterpolator(interpolator)</div><div class="line">                    .setStartDelay(delay);</div><div class="line"></div><div class="line">            <span class="keyword">if</span> (callbacks.size() &gt; <span class="number">0</span>) {</div><div class="line">                <span class="keyword">for</span> (Animator.AnimatorListener callback : callbacks) {</div><div class="line">                    animator.addAnimatorListener(callback);</div><div class="line">                }</div><div class="line">            }</div><div class="line"></div><div class="line">            animator.animate();</div><div class="line">            <span class="keyword">return</span> animator;</div><div class="line">        }</div><div class="line">    }</div><div class="line">    </div><div class="line">    <span class="javadoc">/**</span></div><div class="line">    *动画管理类</div><div class="line">    */</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">AnimManager</span></span>{</div><div class="line"></div><div class="line">        <span class="keyword">private</span> BaseViewAnimator animator;</div><div class="line">        <span class="keyword">private</span> View target;</div><div class="line"></div><div class="line">        <span class="keyword">private</span> <span class="title">AnimManager</span>(BaseViewAnimator animator, View target){</div><div class="line">            <span class="keyword">this</span>.target = target;</div><div class="line">            <span class="keyword">this</span>.animator = animator;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isStarted</span>(){</div><div class="line">            <span class="keyword">return</span> animator.isStarted();</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isRunning</span>(){</div><div class="line">            <span class="keyword">return</span> animator.isRunning();</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">stop</span>(<span class="keyword">boolean</span> reset){</div><div class="line">            animator.cancel();</div><div class="line"></div><div class="line">            <span class="keyword">if</span>(reset)</div><div class="line">                animator.reset(target);</div><div class="line">        }</div><div class="line">    }</div><div class="line"></div><div class="line">}</div></pre></td></tr></table></figure>

<p> 　这段代码使用了类似Dialog的builder模式，感兴趣的可以搜一下 <strong>JAVA设计模式-Builder</strong>.晚点会另开一篇讲解。<br><em>（注： 复杂动画这一部分的内容这里只是拿出来展示和使用，包装和实现是由<a href="https://github.com/daimajia/AndroidViewAnimations" target="_blank" rel="external">代码家</a>大大原创，有想了解更多动画及效果的请点其名字链接）</em></p>
<p> 　运行一下，就可以看到前面所演示的效果了。点击第一下，，伴随着图标变大一下并飘出“+1”的效果，图片切换到选中状态；再点则恢复未选中，而且不会触发动画。<br> 　<br> 　至此，点赞这块内容和关注点也说完了，希望各位能有点儿收获，另外便于自己也能加深理解。<br> 　最后，附上示例源码地址：<br> 　<br> 　<a href="http://download.csdn.net/detail/u011254308/8718381" target="_blank" rel="external"><strong>点击下载源码示例demo</strong></a></p>
<hr>
  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/学习日志/">学习日志</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Android基础/">Android基础</a>
  </div>

</div>


<div class="article-share" id="share">

  <div data-url="http://qiaoidea.github.io/2015/04/30/android_note/UI--微博（动态）点赞，简单效果中的不简单门道/" data-title="UI--微博（动态）点赞，简单效果中的不简单门道 | Qiaoidea&#39;s Blog" data-tsina="5288126184" class="share clearfix">
  </div>

</div>
</footer>   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2015/05/03/android_note/UI--从学习styleable自定义view属性到一点儿更有意思的尝试/" title="UI--从学习styleable自定义view属性到一点儿更有意思的尝试">
  <strong>上一篇：</strong><br/>
  <span>
  UI--从学习styleable自定义view属性到一点儿更有意思的尝试</span>
</a>
</div>


<div class="next">
<a href="/2015/04/27/android_note/UI--多行文本折叠展开效果/"  title="UI--多行文本折叠展开效果">
 <strong>下一篇：</strong><br/> 
 <span>UI--多行文本折叠展开效果
</span>
</a>
</div>

</nav>

	
<section id="comments" class="comment">
	<div class="ds-thread"></div>
</section>


</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
 
 <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#《代码里的世界》_—-UI篇"><span class="toc-number">1.</span> <span class="toc-text">《代码里的世界》  —-UI篇</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-概述"><span class="toc-number">2.</span> <span class="toc-text">1.概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">3.</span> <span class="toc-text"></span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-从实现看门道"><span class="toc-number">4.</span> <span class="toc-text">2.从实现看门道</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1_Checkable接口实现CheckedImageView"><span class="toc-number">4.1.</span> <span class="toc-text">2.1 Checkable接口实现CheckedImageView</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2_动画库的封装和快速框架"><span class="toc-number">4.2.</span> <span class="toc-text">2.2 动画库的封装和快速框架</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-_首先定义一个基本动画效果类BaseViewAnimator"><span class="toc-number">4.2.1.</span> <span class="toc-text">1. 首先定义一个基本动画效果类BaseViewAnimator</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-_其次基于这个类实现我们的各种动画效果XXAnimator"><span class="toc-number">4.2.2.</span> <span class="toc-text">2. 其次基于这个类实现我们的各种动画效果XXAnimator</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-_最后封装一个动画管理工具类AnimHelper供外部使用"><span class="toc-number">4.2.3.</span> <span class="toc-text">3. 最后封装一个动画管理工具类AnimHelper供外部使用</span></a></li></ol></li></ol></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  <div class="weiboshow">
  <p class="asidetitle">新浪微博</p>
    <iframe width="100%" height="119" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=119&fansRow=2&ptype=1&speed=0&skin=9&isTitle=1&noborder=1&isWeibo=0&isFans=0&uid=5288126184&verifier=4988e869&dpc=1"></iframe>
</div>


  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
			<li><a href="/categories/MarkDown/" title="MarkDown">MarkDown<sup>3</sup></a></li>
		
			<li><a href="/categories/《每日墓志铭》/" title="《每日墓志铭》">《每日墓志铭》<sup>1</sup></a></li>
		
			<li><a href="/categories/学习日志/" title="学习日志">学习日志<sup>18</sup></a></li>
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			<li><a href="/tags/Android基础/" title="Android基础">Android基础<sup>16</sup></a></li>
		
			<li><a href="/tags/Markdown语法/" title="Markdown语法">Markdown语法<sup>3</sup></a></li>
		
			<li><a href="/tags/Github/" title="Github">Github<sup>1</sup></a></li>
		
			<li><a href="/tags/Hexo/" title="Hexo">Hexo<sup>1</sup></a></li>
		
			<li><a href="/tags/DailyEpitaph/" title="DailyEpitaph">DailyEpitaph<sup>1</sup></a></li>
		
			<li><a href="/tags/ViewGroup/" title="ViewGroup">ViewGroup<sup>1</sup></a></li>
		
		</ul>
</div>


  
  <div class="tagcloudlist">
    <p class="asidetitle">标签云</p>
    <div class="tagcloudlist clearfix">
       <a href="/tags/Android基础/" style="font-size: 20.00px;">Android基础</a><a href="/tags/DailyEpitaph/" style="font-size: 10.00px;">DailyEpitaph</a><a href="/tags/Github/" style="font-size: 10.00px;">Github</a><a href="/tags/Hexo/" style="font-size: 10.00px;">Hexo</a><a href="/tags/Markdown语法/" style="font-size: 15.00px;">Markdown语法</a><a href="/tags/ViewGroup/" style="font-size: 10.00px;">ViewGroup</a>
    </div>
  </div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
         
           <li>
             
             	<a href="http://blog.csdn.net/qiaoidea" target="_blank" title="Qiao&#39;s CSDN">Qiao&#39;s CSDN</a>
             
           </li>
         
           <li>
             
             	<a href="http://user.qzone.qq.com/378675427 " target="_blank" title="Qiao的QQ空间">Qiao&#39;s QQ</a>
             
           </li>
         
           <li>
             
             	<a href="http://hexo.io " target="_blank" title="Hexo官方网站">Hexo</a>
             
           </li>
         
     </ul>
</div>

  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> 一时不学，差之毫厘； <br/>
			终日不学，失之千里。</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		<a href="http://weibo.com/5288126184" target="_blank" class="icon-weibo" title="微博"></a>
		
		
		
		
		
		
		
		
		
		
	</div>
		<p class="copyright">Powered by <a href="http://zespia.tw/hexo/" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Pacman">Jacman</a> © 2015 
		
		<a href="http://qiaoidea.github.io/about" target="_blank" title="Qiaoidea">Qiaoidea</a>
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else
    {
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      h  = $('article h2')
      ah = $('article h2'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  if(ah.length==0){
    t.css('display','none');
  }else{
    c.click(function(){
      ta.css('display', 'block').addClass('fadeIn');
    });
    o.click(function(){
      ta.css('display', 'none');
    });
    $(window).scroll(function(){
      ta.css("top",Math.max(140,320-$(this).scrollTop()));
    });
  };
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<a href="#" class="overlay" id="qrcode"></a>',
  '<div class="qrcode clearfix"><span>扫描二维码分享到微信朋友圈</span><a class="qrclose" href="#nothing"></a><strong>Loading...Please wait</strong><img id="qrcode-pic" data-src="http://s.jiathis.com/qrcode.php?url=' + encodedUrl + '"/></div>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);
  $('.article-share-qrcode').click(function(){
    var imgSrc = $('#qrcode-pic').attr('data-src');
    $('#qrcode-pic').attr('src', imgSrc);
    $('#qrcode-pic').load(function(){
        $('.qrcode strong').text(' ');
    });
  });
});     
</script>



<script type="text/javascript">
  var duoshuoQuery = {short_name:"qiaoidea"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 







<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->





<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

  </body>
</html>
