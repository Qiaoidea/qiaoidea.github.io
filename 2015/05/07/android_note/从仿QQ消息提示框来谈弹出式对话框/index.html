
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
    <title>从仿QQ消息提示框来谈弹出式对话框 | Qiaoidea&#39;s Blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="Qiaoidea">
    
    <meta name="description" content="《代码里的世界》  —-UI篇

用文字札记描绘自己 android学习之路
转载请保留出处 by Qiaohttp://blog.csdn.net/qiaoidea/article/details/45896477

【导航】

自定义弹出式对话框的简单用法    列举各种常见的对话框实现方案


1.概述
　　android原生控件向来以丑著称(新推出的Material Design当另说)，因此几乎所有的应用都会特殊定制自己的UI样式。而其中弹出式提示框的定制尤为常见，本篇我们将从模仿QQ退出提示框来看一下常见的几种自定义提示框的实现方式。　　这里使用的几种弹出框实现方法概括为以下几种：

自定义Dialog
自定义PopupWindow
自定义Layout View
Activity的Dialog样式
FragmentDialog

　　先看下最终的效果图：

2.实践
　　前面提到几种实现方式均可以达到同样的演示效果，但其中又是各有不同。这里先逐一列举各种具体实现，最后加以综述总结和归纳吧。　　在此之前呢，先看一下这里实现的对话框共用布局layout/confirm_dialog.xml 。">
    
    
    
    
    <link rel="alternative" href="/atom.xml" title="Qiaoidea&#39;s Blog" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css" type="text/css">

</head>

  <body>
    <header>
      <div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="Qiaoidea&#39;s Blog" title="Qiaoidea&#39;s Blog"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="Qiaoidea&#39;s Blog">Qiaoidea&#39;s Blog</a></h1>
				<h2 class="blog-motto">你必须非常努力，才能看起来毫不费力。</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">主页</a></li>
					
						<li><a href="/programing_art">编程艺术</a></li>
					
						<li><a href="/archives">归档</a></li>
					
						<li><a href="/dj">札记</a></li>
					
						<li><a href="/about">关于</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:qiaoidea.github.io">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/05/07/android_note/从仿QQ消息提示框来谈弹出式对话框/" title="从仿QQ消息提示框来谈弹出式对话框" itemprop="url">从仿QQ消息提示框来谈弹出式对话框</a>
  </h1>
  <p class="article-author">By
       
		<a href="http://qiaoidea.github.io/about" title="Qiaoidea" target="_blank" itemprop="author">Qiaoidea</a>
		
  <p class="article-time">
    <time datetime="2015-05-06T16:00:00.000Z" itemprop="datePublished"> 发表于 5月 7 2015</time>
    
  </p>
</header>
	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		
			<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#《代码里的世界》_—-UI篇"><span class="toc-number">1.</span> <span class="toc-text">《代码里的世界》  —-UI篇</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-概述"><span class="toc-number">2.</span> <span class="toc-text">1.概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-实践"><span class="toc-number">3.</span> <span class="toc-text">2.实践</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1_Dialog_"><span class="toc-number">3.1.</span> <span class="toc-text">2.1 Dialog　</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2_PopupWindow_"><span class="toc-number">3.2.</span> <span class="toc-text">2.2 PopupWindow　</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3_自定义Layout_"><span class="toc-number">3.3.</span> <span class="toc-text">2.3 自定义Layout　</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-初始化View"><span class="toc-number">3.3.1.</span> <span class="toc-text">1.初始化View</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-显示自定义VIew_:_show()"><span class="toc-number">3.3.2.</span> <span class="toc-text">2.显示自定义VIew : show()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-隐藏自定义VIew_:_hide()"><span class="toc-number">3.3.3.</span> <span class="toc-text">3.隐藏自定义VIew : hide()</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4_Activity的Dialog样式_"><span class="toc-number">3.4.</span> <span class="toc-text">2.4 Activity的Dialog样式　</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5_DialogFragment_"><span class="toc-number">3.5.</span> <span class="toc-text">2.5 DialogFragment　</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-小结"><span class="toc-number">4.</span> <span class="toc-text">3.小结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-补充"><span class="toc-number">5.</span> <span class="toc-text">4.补充</span></a></li></ol>
		
		</div>
		
		<h2 id="《代码里的世界》_—-UI篇"><strong>《代码里的世界》</strong>  —-<strong><em>UI篇</em></strong></h2>
<blockquote>
<p>用文字札记描绘自己 android学习之路</p>
<p><em>转载请保留出处 by Qiao</em><br><a href="http://blog.csdn.net/qiaoidea/article/details/45896477" target="_blank" rel="external">http://blog.csdn.net/qiaoidea/article/details/45896477</a></p>
</blockquote>
<p><strong>【导航】</strong></p>
<ul>
<li><a href="http://www.oschina.net/question/54100_32486" target="_blank" rel="external">自定义弹出式对话框的简单用法</a>    列举各种常见的对话框实现方案</li>
</ul>
<hr>
<h2 id="1-概述"><strong>1.概述</strong></h2>
<p>　　android原生控件向来以丑著称(新推出的Material Design当另说)，因此几乎所有的应用都会特殊定制自己的UI样式。而其中弹出式提示框的定制尤为常见，本篇我们将从模仿QQ退出提示框来看一下常见的几种自定义提示框的实现方式。<br>　　这里使用的几种弹出框实现方法概括为以下几种：</p>
<ol>
<li><strong>自定义Dialog</strong></li>
<li><strong>自定义PopupWindow</strong></li>
<li><strong>自定义Layout View</strong></li>
<li><strong>Activity的Dialog样式</strong></li>
<li><strong>FragmentDialog</strong></li>
</ol>
<p>　　<em>先看下最终的<strong>效果图</strong>：</em><br><img src="http://img.blog.csdn.net/20150522183827934" alt="弹出式对话框"></p>
<hr>
<h2 id="2-实践"><strong>2.实践</strong></h2>
<p>　　前面提到几种实现方式均可以达到同样的演示效果，但其中又是各有不同。这里先逐一列举各种具体实现，最后加以综述总结和归纳吧。<br>　　在此之前呢，先看一下这里实现的对话框共用布局layout/confirm_dialog.xml 。</p>
<a id="more"></a>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div></pre></td><td class="code"><pre><div class="line"><span class="pi">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">LinearLayout</span> <span class="attribute">xmlns:android</span>=<span class="value">"http://schemas.android.com/apk/res/android"</span></span></div><div class="line">    <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span></div><div class="line">    <span class="attribute">android:layout_height</span>=<span class="value">"wrap_content"</span></div><div class="line">    <span class="attribute">android:layout_marginLeft</span>=<span class="value">"5dp"</span></div><div class="line">    <span class="attribute">android:layout_marginRight</span>=<span class="value">"5dp"</span></div><div class="line">    <span class="attribute">android:background</span>=<span class="value">"@drawable/confirm_dialog_bg"</span></div><div class="line">    <span class="attribute">android:orientation</span>=<span class="value">"vertical"</span>&gt;</div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="title">LinearLayout</span></span></div><div class="line">        <span class="attribute">android:layout_width</span>=<span class="value">"fill_parent"</span></div><div class="line">        <span class="attribute">android:layout_height</span>=<span class="value">"wrap_content"</span></div><div class="line">        <span class="attribute">android:background</span>=<span class="value">"@android:color/transparent"</span></div><div class="line">        <span class="attribute">android:orientation</span>=<span class="value">"vertical"</span> &gt;</div><div class="line"></div><div class="line">        <span class="tag">&lt;<span class="title">TextView</span></span></div><div class="line">            <span class="attribute">android:id</span>=<span class="value">"@+id/title_name"</span></div><div class="line">            <span class="attribute">android:layout_width</span>=<span class="value">"fill_parent"</span></div><div class="line">            <span class="attribute">android:layout_height</span>=<span class="value">"wrap_content"</span></div><div class="line">            <span class="attribute">android:gravity</span>=<span class="value">"center_horizontal"</span></div><div class="line">            <span class="attribute">android:paddingBottom</span>=<span class="value">"10dp"</span></div><div class="line">            <span class="attribute">android:paddingTop</span>=<span class="value">"15dp"</span></div><div class="line">            <span class="attribute">android:text</span>=<span class="value">"Message Title"</span></div><div class="line">                <span class="attribute">android:textColor</span>=<span class="value">"@android:color/black"</span></div><div class="line">            <span class="attribute">android:textSize</span>=<span class="value">"20sp"</span></div><div class="line">            <span class="attribute">android:visibility</span>=<span class="value">"visible"</span> /&gt;</div><div class="line">    <span class="tag">&lt;/<span class="title">LinearLayout</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="title">LinearLayout</span></span></div><div class="line">        <span class="attribute">android:layout_width</span>=<span class="value">"fill_parent"</span></div><div class="line">        <span class="attribute">android:layout_height</span>=<span class="value">"fill_parent"</span></div><div class="line">        <span class="attribute">android:background</span>=<span class="value">"@android:color/transparent"</span></div><div class="line">        <span class="attribute">android:orientation</span>=<span class="value">"vertical"</span> &gt;</div><div class="line">        </div><div class="line">        <span class="tag">&lt;<span class="title">TextView</span> </span></div><div class="line">            <span class="attribute">android:id</span>=<span class="value">"@+id/text_view"</span></div><div class="line">            <span class="attribute">android:layout_width</span>=<span class="value">"fill_parent"</span></div><div class="line">            <span class="attribute">android:layout_height</span>=<span class="value">"wrap_content"</span></div><div class="line">        	<span class="attribute">android:layout_marginLeft</span>=<span class="value">"15dp"</span></div><div class="line">        	<span class="attribute">android:layout_marginRight</span>=<span class="value">"15dp"</span></div><div class="line">            <span class="attribute">android:layout_marginTop</span>=<span class="value">"10dp"</span></div><div class="line">            <span class="attribute">android:textColor</span>=<span class="value">"@android:color/black"</span></div><div class="line">            <span class="attribute">android:text</span>=<span class="value">"this is message content"</span></div><div class="line">            <span class="attribute">android:textSize</span>=<span class="value">"16dip"</span>/&gt;</div><div class="line"></div><div class="line">        <span class="tag">&lt;<span class="title">View</span></span></div><div class="line">            <span class="attribute">android:layout_width</span>=<span class="value">"match_parent"</span></div><div class="line">            <span class="attribute">android:layout_height</span>=<span class="value">"1px"</span></div><div class="line">            <span class="attribute">android:layout_marginTop</span>=<span class="value">"15dip"</span></div><div class="line">            <span class="attribute">android:background</span>=<span class="value">"#c5c5c5"</span> /&gt;</div><div class="line"></div><div class="line">        <span class="tag">&lt;<span class="title">LinearLayout</span></span></div><div class="line">            <span class="attribute">android:layout_width</span>=<span class="value">"fill_parent"</span></div><div class="line">            <span class="attribute">android:layout_height</span>=<span class="value">"50dip"</span></div><div class="line">        	<span class="attribute">android:background</span>=<span class="value">"@android:color/transparent"</span></div><div class="line">            <span class="attribute">android:gravity</span>=<span class="value">"center_horizontal"</span></div><div class="line">            <span class="attribute">android:orientation</span>=<span class="value">"horizontal"</span> &gt;</div><div class="line"></div><div class="line">            <span class="comment">&lt;!-- 取消按钮 --&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="title">Button</span></span></div><div class="line">                <span class="attribute">android:id</span>=<span class="value">"@+id/btn_cancel"</span></div><div class="line">                <span class="attribute">android:layout_width</span>=<span class="value">"wrap_content"</span></div><div class="line">                <span class="attribute">android:layout_height</span>=<span class="value">"match_parent"</span></div><div class="line">                <span class="attribute">android:layout_weight</span>=<span class="value">"1"</span></div><div class="line">                <span class="attribute">android:text</span>=<span class="value">"Cancel"</span></div><div class="line">                <span class="attribute">android:textStyle</span>=<span class="value">"bold"</span></div><div class="line">            	<span class="attribute">android:textColor</span>=<span class="value">"#0072c6"</span></div><div class="line">                <span class="attribute">android:background</span>=<span class="value">"@drawable/confirm_dialog_cancel_selector"</span></div><div class="line">                <span class="attribute">android:textSize</span>=<span class="value">"15sp"</span> /&gt;</div><div class="line">            </div><div class="line">            <span class="comment">&lt;!-- 确认按钮 --&gt;</span></div><div class="line">	</div><div class="line">			<span class="tag">&lt;<span class="title">View</span> </span></div><div class="line">			    <span class="attribute">android:layout_width</span>=<span class="value">"1px"</span></div><div class="line">			    <span class="attribute">android:layout_height</span>=<span class="value">"match_parent"</span></div><div class="line">			    <span class="attribute">android:layout_gravity</span>=<span class="value">"center_horizontal"</span></div><div class="line">			    <span class="attribute">android:background</span>=<span class="value">"#c5c5c5"</span>/&gt;</div><div class="line"></div><div class="line">            <span class="tag">&lt;<span class="title">Button</span></span></div><div class="line">                <span class="attribute">android:id</span>=<span class="value">"@+id/btn_ok"</span></div><div class="line">                <span class="attribute">android:layout_width</span>=<span class="value">"wrap_content"</span></div><div class="line">                <span class="attribute">android:layout_height</span>=<span class="value">"match_parent"</span></div><div class="line">                <span class="attribute">android:layout_weight</span>=<span class="value">"1"</span></div><div class="line">                <span class="attribute">android:text</span>=<span class="value">"OK"</span></div><div class="line">                <span class="attribute">android:textStyle</span>=<span class="value">"bold"</span></div><div class="line">            	<span class="attribute">android:textColor</span>=<span class="value">"#0072c6"</span></div><div class="line">                <span class="attribute">android:background</span>=<span class="value">"@drawable/confirm_dialog_ok_selector"</span></div><div class="line">                <span class="attribute">android:textSize</span>=<span class="value">"15sp"</span> /&gt;</div><div class="line">        <span class="tag">&lt;/<span class="title">LinearLayout</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="title">LinearLayout</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="title">LinearLayout</span>&gt;</span></div></pre></td></tr></table></figure>

<p>仅仅通过布局预览就可以看到效果了：<br>　　<img src="http://img.blog.csdn.net/20150521222306507" alt="图片预览"><br>　　下边我们分别通过上述几种方式来使用这个布局展示消息提示框。
　　</p>
<h3 id="2-1_Dialog_">2.1 <strong>Dialog</strong>　</h3>
<p>　　这个是最基本也最常见的非阻塞式对话框。具体形式可分为七种，详细参见网上各种文章，随便引用一篇<a href="http://www.oschina.net/question/54100_32486" target="_blank" rel="external">7种形式的Android Dialog使用举例</a>。<br>　　<em>（注：官方在fragmentDialog推出后就不在推荐直接使用Dialog来创建对话框，这是后话）</em><br>　　我们这里自定义的提示框<strong>ConfirmDialog</strong>继承自Dialog,使用confirm_dialog.xml 初始化布局，绑定相应事件。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConfirmDialog</span> <span class="keyword">extends</span> <span class="title">Dialog</span> </span>{</div><div class="line">	<span class="keyword">private</span> Context context;</div><div class="line">	<span class="keyword">private</span> TextView titleTv,contentTv;</div><div class="line">	<span class="keyword">private</span> View okBtn,cancelBtn;</div><div class="line">	<span class="keyword">private</span> OnDialogClickListener dialogClickListener;</div><div class="line"></div><div class="line">	<span class="keyword">public</span> <span class="title">ConfirmDialog</span>(Context context) {</div><div class="line">		<span class="keyword">super</span>(context);</div><div class="line">		<span class="keyword">this</span>.context = context;</div><div class="line">		initalize();</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="comment">//初始化View</span></div><div class="line">	<span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initalize</span>() {</div><div class="line">		LayoutInflater inflater = LayoutInflater.from(context);</div><div class="line">		View view = inflater.inflate(R.layout.confirm_dialog, <span class="keyword">null</span>);</div><div class="line">		setContentView(view);</div><div class="line">		initWindow();</div><div class="line"></div><div class="line">		titleTv = (TextView) findViewById(R.id.title_name);</div><div class="line">		contentTv = (TextView) findViewById(R.id.text_view);</div><div class="line">		okBtn = findViewById(R.id.btn_ok);</div><div class="line">		cancelBtn = findViewById(R.id.btn_cancel);</div><div class="line">		okBtn.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() {</div><div class="line">			</div><div class="line">			<span class="annotation">@Override</span></div><div class="line">			<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span>(View v) {</div><div class="line">				dismiss();</div><div class="line">				<span class="keyword">if</span>(dialogClickListener != <span class="keyword">null</span>){</div><div class="line">					dialogClickListener.onOKClick();</div><div class="line">				}</div><div class="line">			}</div><div class="line">		});</div><div class="line">		cancelBtn.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() {</div><div class="line">			</div><div class="line">			<span class="annotation">@Override</span></div><div class="line">			<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span>(View v) {</div><div class="line">				dismiss();</div><div class="line">				<span class="keyword">if</span>(dialogClickListener != <span class="keyword">null</span>){</div><div class="line">					dialogClickListener.onCancelClick();</div><div class="line">				}</div><div class="line">			}</div><div class="line">		});</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="javadoc">/**</span></div><div class="line">	*添加黑色半透明背景</div><div class="line">	*/</div><div class="line">	<span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initWindow</span>() {</div><div class="line">		Window dialogWindow = getWindow();</div><div class="line">		dialogWindow.setBackgroundDrawable(<span class="keyword">new</span> ColorDrawable(<span class="number">0</span>));<span class="comment">//设置window背景</span></div><div class="line">		dialogWindow.setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_HIDDEN | WindowManager.LayoutParams.SOFT_INPUT_ADJUST_PAN);<span class="comment">//设置输入法显示模式</span></div><div class="line">		WindowManager.LayoutParams lp = dialogWindow.getAttributes();</div><div class="line">		DisplayMetrics d = context.getResources().getDisplayMetrics();<span class="comment">//获取屏幕尺寸</span></div><div class="line">		lp.width = (<span class="keyword">int</span>) (d.widthPixels * <span class="number">0.8</span>); <span class="comment">//宽度为屏幕80% </span></div><div class="line">		lp.gravity = Gravity.CENTER;	 <span class="comment">//中央居中</span></div><div class="line">		dialogWindow.setAttributes(lp);</div><div class="line">	}</div><div class="line">	</div><div class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOnDialogClickListener</span>(OnDialogClickListener clickListener){</div><div class="line">		dialogClickListener = clickListener;</div><div class="line">	}</div><div class="line">	</div><div class="line">	<span class="javadoc">/**</span></div><div class="line">	*添加按钮点击事件</div><div class="line">	*/</div><div class="line">	<span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">OnDialogClickListener</span></span>{</div><div class="line">		<span class="keyword">void</span> onOKClick();</div><div class="line">		<span class="keyword">void</span> onCancelClick();</div><div class="line">	}</div><div class="line">}</div></pre></td></tr></table></figure>

<p>　　 </p>
<h3 id="2-2_PopupWindow_">2.2 <strong>PopupWindow</strong>　</h3>
<p>　　PopupWindow是阻塞式对话框，只有在退出操作时候程序才会继续运行。另外PopupWindow可以根据自由确定自身位置。按照位置有无偏移分，可以分为偏移和无偏移两种；按照参照物的不同，可以分为相对于某个控件（Anchor锚）和相对于父控件。具体如下</p>
<blockquote>
<p><strong>showAsDropDown(View anchor)：</strong>相对某个控件的位置（正左下方），无偏移<br><strong>showAsDropDown(View anchor, int xoff, int yoff)：</strong>相对某个控件的位置（正下方），有偏移<br><strong>showAtLocation(View parent, int gravity, int x, int y)：</strong>相对于父控件的位置（例如正中央Gravity.CENTER，下方Gravity.BOTTOM等），可以设置偏移或无偏移</p>
</blockquote>
<p>这里只是达到同样的显示效果，仅示范下showAtBottom的使用：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConfirmPopWindow</span> <span class="keyword">extends</span> <span class="title">PopupWindow</span></span>{</div><div class="line">	<span class="keyword">private</span> Context context;</div><div class="line">	<span class="keyword">private</span> TextView titleTv,contentTv;</div><div class="line">	<span class="keyword">private</span> View okBtn,cancelBtn;</div><div class="line">	<span class="keyword">private</span> OnDialogClickListener dialogClickListener;</div><div class="line"></div><div class="line">	<span class="keyword">public</span> <span class="title">ConfirmPopWindow</span>(Context context) {</div><div class="line">		<span class="keyword">super</span>(context);</div><div class="line">		<span class="keyword">this</span>.context = context;</div><div class="line">		initalize();</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initalize</span>() {</div><div class="line">		LayoutInflater inflater = LayoutInflater.from(context);</div><div class="line">		View view = inflater.inflate(R.layout.confirm_dialog, <span class="keyword">null</span>);</div><div class="line">		setContentView(view);</div><div class="line">		initWindow();</div><div class="line"></div><div class="line">		titleTv = (TextView) view.findViewById(R.id.title_name);</div><div class="line">		contentTv = (TextView)  view.findViewById(R.id.text_view);</div><div class="line">		okBtn =  view.findViewById(R.id.btn_ok);</div><div class="line">		cancelBtn =  view.findViewById(R.id.btn_cancel);</div><div class="line">		okBtn.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() {</div><div class="line">			</div><div class="line">			<span class="annotation">@Override</span></div><div class="line">			<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span>(View v) {</div><div class="line">				dismiss();</div><div class="line">				<span class="keyword">if</span>(dialogClickListener != <span class="keyword">null</span>){</div><div class="line">					dialogClickListener.onOKClick();</div><div class="line">				}</div><div class="line">			}</div><div class="line">		});</div><div class="line">		cancelBtn.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() {</div><div class="line">			</div><div class="line">			<span class="annotation">@Override</span></div><div class="line">			<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span>(View v) {</div><div class="line">				dismiss();</div><div class="line">				<span class="keyword">if</span>(dialogClickListener != <span class="keyword">null</span>){</div><div class="line">					dialogClickListener.onCancelClick();</div><div class="line">				}</div><div class="line">			}</div><div class="line">		});</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initWindow</span>() {</div><div class="line">		<span class="keyword">this</span>.setBackgroundDrawable(<span class="keyword">new</span> ColorDrawable(<span class="number">0</span>)); </div><div class="line">		DisplayMetrics d = context.getResources().getDisplayMetrics();</div><div class="line">		<span class="keyword">this</span>.setWidth((<span class="keyword">int</span>) (d.widthPixels * <span class="number">0.8</span>));  </div><div class="line">		<span class="keyword">this</span>.setHeight(LayoutParams.WRAP_CONTENT);  </div><div class="line">		<span class="keyword">this</span>.setFocusable(<span class="keyword">true</span>);  </div><div class="line">		<span class="keyword">this</span>.setOutsideTouchable(<span class="keyword">true</span>);  </div><div class="line">		<span class="keyword">this</span>.update();  </div><div class="line">	}</div><div class="line">	</div><div class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">showAtBottom</span>(View view){</div><div class="line">		showAsDropDown(view, Math.abs((view.getWidth() - getWidth())/<span class="number">2</span>), <span class="number">20</span>);</div><div class="line">	}</div><div class="line">	</div><div class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOnDialogClickListener</span>(OnDialogClickListener clickListener){</div><div class="line">		dialogClickListener = clickListener;</div><div class="line">	}</div><div class="line">	</div><div class="line">	<span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">OnDialogClickListener</span></span>{</div><div class="line">		<span class="keyword">void</span> onOKClick();</div><div class="line">		<span class="keyword">void</span> onCancelClick();</div><div class="line">	}</div><div class="line">}</div></pre></td></tr></table></figure>

<p>　　
　　</p>
<h3 id="2-3_自定义Layout_">2.3 <strong>自定义Layout</strong>　</h3>
<p>　　前边两种是系统封装好的View ,同样的，我们也可以自定义layout布局来实现的弹出式对话框效果。既然是自定义，有必要细致讲述一下，<br>　　ConfirmLayout继承自FrameLayout，通过获取窗口管理器WindowManager 将我们的自定义view添加到窗口最前端并显示出来，达到预期效果。
　　　　</p>
<h4 id="1-初始化View">1.<strong>初始化View</strong></h4>
<p>　　先初始化半透明黑色背景和对应的confirm_layout，然后给窗体添加按键返回事件</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">initialize</span>() {</div><div class="line">	initBackground();<span class="comment">//初始化黑色背景</span></div><div class="line">	initContentView();<span class="comment">//初始化confirm_layout 对应的View</span></div><div class="line">	</div><div class="line">	windowManager = (WindowManager) getContext().getSystemService(Context.WINDOW_SERVICE);</div><div class="line">	setOnKeyListener(<span class="keyword">new</span> OnKeyListener() { <span class="comment">//添加按键返回事件</span></div><div class="line">		<span class="annotation">@Override</span></div><div class="line">		<span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onKey</span>(View v, <span class="keyword">int</span> keyCode, KeyEvent event) {</div><div class="line">			<span class="keyword">if</span> (KeyEvent.KEYCODE_BACK == keyCode && KeyEvent.ACTION_DOWN == event.getAction()) {</div><div class="line">				hide();<span class="comment">//隐藏当前view</span></div><div class="line">				<span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">			}</div><div class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">		}</div><div class="line"></div><div class="line">	setFocusable(<span class="keyword">true</span>); <span class="comment">//可获得焦点</span></div><div class="line">	setFocusableInTouchMode(<span class="keyword">true</span>); <span class="comment">//可触碰获得焦点</span></div><div class="line">}</div></pre></td></tr></table></figure>

<p>　　</p>
<h4 id="2-显示自定义VIew_:_show()">2.<strong>显示自定义VIew : show()</strong></h4>
<p>　　调用显示的时候保证在主线程中，如果当前View没有被添加至窗口中，则添加；然后使用动画渐变效果显示背景，最后动画完成时显示当前对话框View.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span>() {</div><div class="line">		((Activity) getContext()).runOnUiThread(<span class="keyword">new</span> Runnable() {</div><div class="line">			<span class="annotation">@Override</span></div><div class="line">			<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span>() {</div><div class="line">				<span class="keyword">if</span> (getParent() == <span class="keyword">null</span>) { <span class="comment">//没有添加则添加至窗体</span></div><div class="line">					<span class="comment">//获取窗体的布局属性，设置左上角对齐，填充父容器</span></div><div class="line">					WindowManager.LayoutParams wlp = <span class="keyword">new</span> WindowManager.LayoutParams();</div><div class="line">					wlp.type = WindowManager.LayoutParams.TYPE_APPLICATION;</div><div class="line">					wlp.format = PixelFormat.TRANSPARENT;</div><div class="line">					wlp.gravity = Gravity.LEFT | Gravity.TOP;</div><div class="line">					wlp.width = LayoutParams.MATCH_PARENT;</div><div class="line">					wlp.height = LayoutParams.MATCH_PARENT;</div><div class="line">					windowManager.addView(ConfirmLayout.<span class="keyword">this</span>, wlp);</div><div class="line">				}</div><div class="line">				showBackGround();<span class="comment">//显示背景动画和自定义View</span></div><div class="line">			}</div><div class="line">		});</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="javadoc">/**</span></div><div class="line">	*显示背景动画</div><div class="line">	*/</div><div class="line">	<span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">showBackGround</span>() {</div><div class="line">        <span class="keyword">if</span> (isShowing)</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        isShowing = <span class="keyword">true</span>;</div><div class="line">        background.clearAnimation();</div><div class="line">        background.setVisibility(View.VISIBLE);</div><div class="line">        AlphaAnimation an = <span class="keyword">new</span> AlphaAnimation(<span class="number">0</span>, <span class="number">1</span>);</div><div class="line">        an.setDuration(durationMillis);</div><div class="line">        background.startAnimation(an);</div><div class="line">    }</div></pre></td></tr></table></figure>

<p>　　</p>
<h4 id="3-隐藏自定义VIew_:_hide()">3.<strong>隐藏自定义VIew : hide()</strong></h4>
<p>　　隐藏对话框的方法跟show()恰恰相反，首先调用隐藏动画，动画结束从窗体中移除View</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">hide</span>() {</div><div class="line">	((Activity) getContext()).runOnUiThread(<span class="keyword">new</span> Runnable() {</div><div class="line">		<span class="annotation">@Override</span></div><div class="line">		<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span>() {</div><div class="line">			hideBackGround();<span class="comment">//隐藏背景</span></div><div class="line">			<span class="keyword">if</span> (getParent() != <span class="keyword">null</span>)</div><div class="line">				windowManager.removeView(ConfirmLayout.<span class="keyword">this</span>);<span class="comment">//移除view</span></div><div class="line">		}</div><div class="line">	});</div><div class="line">}</div><div class="line"></div><div class="line"><span class="javadoc">/**</span></div><div class="line">*隐藏背景背景动画</div><div class="line">*/</div><div class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">hideBackGround</span>() {</div><div class="line">       <span class="keyword">if</span> (!isShowing)</div><div class="line">           <span class="keyword">return</span>;</div><div class="line">       isShowing = <span class="keyword">false</span>;</div><div class="line">       background.clearAnimation();</div><div class="line">       AlphaAnimation an = <span class="keyword">new</span> AlphaAnimation(<span class="number">1</span>, <span class="number">0</span>);</div><div class="line">       an.setDuration(durationMillis);</div><div class="line">       an.setAnimationListener(<span class="keyword">new</span> AnimationListener() {</div><div class="line">           <span class="annotation">@Override</span></div><div class="line">           <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationStart</span>(Animation animation) {</div><div class="line">           }</div><div class="line"></div><div class="line">           <span class="annotation">@Override</span></div><div class="line">           <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationRepeat</span>(Animation animation) {</div><div class="line">           }</div><div class="line"></div><div class="line">           <span class="annotation">@Override</span></div><div class="line">           <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationEnd</span>(Animation animation) {</div><div class="line">           	background.setVisibility(View.GONE);</div><div class="line">           }</div><div class="line">       });</div><div class="line">       background.startAnimation(an);</div><div class="line">   }</div></pre></td></tr></table></figure>


<p>　　其他部分同上，不再一一贴出，详细可查看示例源码。
　　
　　</p>
<h3 id="2-4_Activity的Dialog样式_">2.4 <strong>Activity的Dialog样式</strong>　</h3>
<p>　　通过使用主题Theme来实现Activity作为一个dialog来显示的效果。我们首先在 <strong>AndroidManifest.xml</strong> 中配置该activity，使得</p>
<blockquote>
<p>android:theme=”@android:style/Theme.Dialog”</p>
</blockquote>
<p>同样我们可以自定义继承于Theme.Dialog的style样式增加自定义属性，比如：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="title">resources</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="title">style</span> <span class="attribute">name</span>=<span class="value">"DialogStyle"</span> <span class="attribute">parent</span>=<span class="value">"@android:style/Theme.Dialog"</span>&gt;</span><span class="css"></span></div><div class="line">        &lt;<span class="tag">item</span> <span class="tag">name</span>="<span class="tag">android</span><span class="pseudo">:windowBackground"</span>&gt;<span class="at_rule">@<span class="keyword">android:color/transparent&lt;/item&gt;</span></span></div><div class="line">        &lt;item name=<span class="string">"android:windowFrame"</span>&gt;@null&lt;/item&gt;</div><div class="line">        &lt;item name=<span class="string">"android:windowNoTitle"</span>&gt;true&lt;/item&gt;</div><div class="line">        &lt;item name=<span class="string">"android:windowIsFloating"</span>&gt;true&lt;/item&gt;</div><div class="line">        &lt;item name=<span class="string">"android:windowIsTranslucent"</span>&gt;true&lt;/item&gt;</div><div class="line">        &lt;item name=<span class="string">"android:windowFullscreen"</span>&gt;true&lt;/item&gt;</div><div class="line">        &lt;item name=<span class="string">"android:backgroundDimEnabled"</span>&gt;true&lt;/item&gt;</div><div class="line">    <span class="tag">&lt;/<span class="title">style</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="title">resources</span>&gt;</span></div></pre></td></tr></table></figure>

<p>然后使用</p>
<blockquote>
<p>android:theme=”@style/DialogStyle”</p>
</blockquote>
<p>达到上述效果。具体实现跟dialog类似：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConfirmActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span></span>{</div><div class="line">	<span class="keyword">private</span> TextView titleTv,contentTv;</div><div class="line">	<span class="keyword">private</span> View okBtn,cancelBtn;</div><div class="line">	<span class="keyword">private</span> OnDialogClickListener dialogClickListener;</div><div class="line">	</div><div class="line">	<span class="annotation">@Override</span></div><div class="line">	<span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span>(Bundle savedInstanceState) {</div><div class="line">		<span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">        requestWindowFeature(Window.FEATURE_NO_TITLE);</div><div class="line">		setContentView(R.layout.confirm_dialog);</div><div class="line">        initViews();</div><div class="line">        initListeners();</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initViews</span>() {</div><div class="line">		initWindow();</div><div class="line">		titleTv = (TextView) findViewById(R.id.title_name);</div><div class="line">		contentTv = (TextView) findViewById(R.id.text_view);</div><div class="line">		okBtn = findViewById(R.id.btn_ok);</div><div class="line">		cancelBtn = findViewById(R.id.btn_cancel);</div><div class="line">		okBtn.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() {</div><div class="line">			</div><div class="line">			<span class="annotation">@Override</span></div><div class="line">			<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span>(View v) {</div><div class="line">				finish();</div><div class="line">				<span class="keyword">if</span>(dialogClickListener != <span class="keyword">null</span>){</div><div class="line">					dialogClickListener.onOKClick();</div><div class="line">				}</div><div class="line">			}</div><div class="line">		});</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initWindow</span>() {</div><div class="line">       getWindow().setBackgroundDrawable(<span class="keyword">new</span> ColorDrawable(<span class="number">0</span>));</div><div class="line">       getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_HIDDEN |</div><div class="line">               WindowManager.LayoutParams.SOFT_INPUT_ADJUST_PAN);</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initListeners</span>() {</div><div class="line">		cancelBtn.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() {</div><div class="line">			</div><div class="line">			<span class="annotation">@Override</span></div><div class="line">			<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span>(View v) {</div><div class="line">				finish();</div><div class="line">				<span class="keyword">if</span>(dialogClickListener != <span class="keyword">null</span>){</div><div class="line">					dialogClickListener.onCancelClick();</div><div class="line">				}</div><div class="line">			}</div><div class="line">		});</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOnDialogClickListener</span>(OnDialogClickListener clickListener){</div><div class="line">		dialogClickListener = clickListener;</div><div class="line">	}</div><div class="line">	</div><div class="line">	</div><div class="line">	<span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">OnDialogClickListener</span></span>{</div><div class="line">		<span class="keyword">void</span> onOKClick();</div><div class="line">		<span class="keyword">void</span> onCancelClick();</div><div class="line">	}</div><div class="line">}</div></pre></td></tr></table></figure>

<h3 id="2-5_DialogFragment_">2.5 <strong>DialogFragment</strong>　</h3>
<p>　　DialogFragment在android 3.0时被引入并被加以推广。<br>　　我们在使用DialogFragment时，至少需要实现onCreateView或者onCreateDIalog方法。这里在onCreateDIalog中直接返回前面写好的ConfirmDialog来实现这个Fragment。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConfirmFragment</span> <span class="keyword">extends</span> <span class="title">DialogFragment</span></span>{</div><div class="line">	</div><div class="line">	<span class="annotation">@Override</span></div><div class="line">	<span class="annotation">@NonNull</span></div><div class="line">	<span class="keyword">public</span> Dialog <span class="title">onCreateDialog</span>(Bundle savedInstanceState) {</div><div class="line">		<span class="keyword">return</span> <span class="keyword">new</span> ConfirmDialog(getActivity());</div><div class="line">	}</div><div class="line">	</div><div class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOnDialogClickListener</span>(OnDialogClickListener clickListener){</div><div class="line">		((ConfirmDialog)getDialog()).setOnDialogClickListener(clickListener);</div><div class="line">	}</div><div class="line">}</div></pre></td></tr></table></figure>

<p>　　当然并不推荐偷懒直接返回前面定义好的ConfirmDialog。我们实际上使用fragment的onCreateView也更合理和简介，他可以产生同样的Dialog效果,同时可以作为内嵌fragment引用。从使用总结来看，FragmentDialog 相较于Dialog有两点好处：</p>
<ul>
<li><p>在手机配置变化，导致Activity需要重新创建时，例如旋屏，DialogFragment对话框将会由FragmentManager自动重建，然而Dialog实现的对话框则不会重新生成；</p>
</li>
<li><p>DialogFragment还拥有fragment的优点，即可以在一个Activity内部实现回退（因为FragmentManager会管理一个回退栈 ，另外，他可以直接作为一个普通Fragment嵌套在其他布局里边；</p>
</li>
</ul>
<hr>
<h2 id="3-小结"><strong>3.小结</strong></h2>
<p>　　从实现效果来看我们确实有很多选择，当然我们用的最多的必然要数Dialog（FragmentDialog）和PopupWindow了。但在一般情况下，选择Dialog和PopupWindow是由我们的具体使用场景来定。比如有些提示消息，比较适合Dialog，而弹出一些具体选项，需要等待选择结果等情况，更倾向于使用PopupWindow了。</p>
<ul>
<li><p>FragmentDialog的几种使用场景</p>
<p><br><img src="http://img.blog.csdn.net/20150522190548492" width="350"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br><img src="http://img.blog.csdn.net/20150522191506852" width="350"><br></p>


</li>
</ul>
<ul>
<li><p>PopupWindow的几种使用场景</p>
<p><br><img src="http://img.blog.csdn.net/20150522191717907" width="200"><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br><img src="http://img.blog.csdn.net/20150522191721289" width="170"><br></p>

</li>
</ul>
<hr>
<h2 id="4-补充"><strong>4.补充</strong></h2>
<p>　　其实还有种长按弹出菜单，这种除了可以通过上述方法弹出菜单选项外，还可以通过系统提供的 View.setOnCreateContextMenu()方法来实现。比如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">itemView.setOnCreateContextMenuListener(<span class="keyword">new</span> View.OnCreateContextMenuListener() {</div><div class="line">                <span class="annotation">@Override</span></div><div class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreateContextMenu</span>(ContextMenu menu, View v, ContextMenu.ContextMenuInfo menuInfo) {</div><div class="line">                    menu.add(<span class="string">"删除"</span>).setOnMenuItemClickListener(<span class="keyword">new</span> MenuItem.OnMenuItemClickListener() {</div><div class="line">                        <span class="annotation">@Override</span></div><div class="line">                        <span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onMenuItemClick</span>(MenuItem item) {</div><div class="line">                            <span class="comment">//执行删除操作</span></div><div class="line">                            <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">                        }</div><div class="line">                    });</div><div class="line">                }</div><div class="line">            });</div></pre></td></tr></table></figure>


<p>长按弹出，基本效果为：<br><img src="http://img.blog.csdn.net/20150522202348547" alt="onCreateContextMenu"><br>　　有兴趣的不妨试一下。</p>
<p>　　后边的话我们先从源码角度来看一下这里讲的几种实现方案的具体原理，最后通过一些简易封装来做一个<strong>类似IOS上的ActionSheet控件</strong>的效果。<br>　　演示效果大概为：<br>　　<br>　　<img src="http://img.blog.csdn.net/20150522203925438" alt="ActionSheet"><br>　　详情请继续关注接下来的博文。</p>
<hr>
<p>最后附上本篇所讲内容的源码：<br><a href="http://download.csdn.net/detail/u011254308/8729217" target="_blank" rel="external">示例源码demo下载地址</a>（已重新更新）</p>
<hr>
  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/学习日志/">学习日志</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Android基础/">Android基础</a>
  </div>

</div>


<div class="article-share" id="share">

  <div data-url="http://qiaoidea.github.io/2015/05/07/android_note/从仿QQ消息提示框来谈弹出式对话框/" data-title="从仿QQ消息提示框来谈弹出式对话框 | Qiaoidea&#39;s Blog" data-tsina="5288126184" class="share clearfix">
  </div>

</div>
</footer>   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2015/05/15/android_note/Dialog与FragmentDialog源码解析/" title="Dialog与FragmentDialog源码解析">
  <strong>上一篇：</strong><br/>
  <span>
  Dialog与FragmentDialog源码解析</span>
</a>
</div>


<div class="next">
<a href="/2015/05/03/android_note/UI--从学习styleable自定义view属性到一点儿更有意思的尝试/"  title="UI--从学习styleable自定义view属性到一点儿更有意思的尝试">
 <strong>下一篇：</strong><br/> 
 <span>UI--从学习styleable自定义view属性到一点儿更有意思的尝试
</span>
</a>
</div>

</nav>

	
<section id="comments" class="comment">
	<div class="ds-thread"></div>
</section>


</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
 
 <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#《代码里的世界》_—-UI篇"><span class="toc-number">1.</span> <span class="toc-text">《代码里的世界》  —-UI篇</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-概述"><span class="toc-number">2.</span> <span class="toc-text">1.概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-实践"><span class="toc-number">3.</span> <span class="toc-text">2.实践</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1_Dialog_"><span class="toc-number">3.1.</span> <span class="toc-text">2.1 Dialog　</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2_PopupWindow_"><span class="toc-number">3.2.</span> <span class="toc-text">2.2 PopupWindow　</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3_自定义Layout_"><span class="toc-number">3.3.</span> <span class="toc-text">2.3 自定义Layout　</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-初始化View"><span class="toc-number">3.3.1.</span> <span class="toc-text">1.初始化View</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-显示自定义VIew_:_show()"><span class="toc-number">3.3.2.</span> <span class="toc-text">2.显示自定义VIew : show()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-隐藏自定义VIew_:_hide()"><span class="toc-number">3.3.3.</span> <span class="toc-text">3.隐藏自定义VIew : hide()</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4_Activity的Dialog样式_"><span class="toc-number">3.4.</span> <span class="toc-text">2.4 Activity的Dialog样式　</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5_DialogFragment_"><span class="toc-number">3.5.</span> <span class="toc-text">2.5 DialogFragment　</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-小结"><span class="toc-number">4.</span> <span class="toc-text">3.小结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-补充"><span class="toc-number">5.</span> <span class="toc-text">4.补充</span></a></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  <div class="weiboshow">
  <p class="asidetitle">新浪微博</p>
    <iframe width="100%" height="119" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=119&fansRow=2&ptype=1&speed=0&skin=9&isTitle=1&noborder=1&isWeibo=0&isFans=0&uid=5288126184&verifier=4988e869&dpc=1"></iframe>
</div>


  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
			<li><a href="/categories/MarkDown/" title="MarkDown">MarkDown<sup>3</sup></a></li>
		
			<li><a href="/categories/《每日墓志铭》/" title="《每日墓志铭》">《每日墓志铭》<sup>1</sup></a></li>
		
			<li><a href="/categories/学习日志/" title="学习日志">学习日志<sup>18</sup></a></li>
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			<li><a href="/tags/Android基础/" title="Android基础">Android基础<sup>16</sup></a></li>
		
			<li><a href="/tags/Markdown语法/" title="Markdown语法">Markdown语法<sup>3</sup></a></li>
		
			<li><a href="/tags/Github/" title="Github">Github<sup>1</sup></a></li>
		
			<li><a href="/tags/Hexo/" title="Hexo">Hexo<sup>1</sup></a></li>
		
			<li><a href="/tags/DailyEpitaph/" title="DailyEpitaph">DailyEpitaph<sup>1</sup></a></li>
		
			<li><a href="/tags/ViewGroup/" title="ViewGroup">ViewGroup<sup>1</sup></a></li>
		
		</ul>
</div>


  
  <div class="tagcloudlist">
    <p class="asidetitle">标签云</p>
    <div class="tagcloudlist clearfix">
       <a href="/tags/Android基础/" style="font-size: 20.00px;">Android基础</a><a href="/tags/DailyEpitaph/" style="font-size: 10.00px;">DailyEpitaph</a><a href="/tags/Github/" style="font-size: 10.00px;">Github</a><a href="/tags/Hexo/" style="font-size: 10.00px;">Hexo</a><a href="/tags/Markdown语法/" style="font-size: 15.00px;">Markdown语法</a><a href="/tags/ViewGroup/" style="font-size: 10.00px;">ViewGroup</a>
    </div>
  </div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
         
           <li>
             
             	<a href="http://blog.csdn.net/qiaoidea" target="_blank" title="Qiao&#39;s CSDN">Qiao&#39;s CSDN</a>
             
           </li>
         
           <li>
             
             	<a href="http://user.qzone.qq.com/378675427 " target="_blank" title="Qiao的QQ空间">Qiao&#39;s QQ</a>
             
           </li>
         
           <li>
             
             	<a href="http://hexo.io " target="_blank" title="Hexo官方网站">Hexo</a>
             
           </li>
         
     </ul>
</div>

  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> 一时不学，差之毫厘； <br/>
			终日不学，失之千里。</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		<a href="http://weibo.com/5288126184" target="_blank" class="icon-weibo" title="微博"></a>
		
		
		
		
		
		
		
		
		
		
	</div>
		<p class="copyright">Powered by <a href="http://zespia.tw/hexo/" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Pacman">Jacman</a> © 2015 
		
		<a href="http://qiaoidea.github.io/about" target="_blank" title="Qiaoidea">Qiaoidea</a>
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else
    {
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      h  = $('article h2')
      ah = $('article h2'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  if(ah.length==0){
    t.css('display','none');
  }else{
    c.click(function(){
      ta.css('display', 'block').addClass('fadeIn');
    });
    o.click(function(){
      ta.css('display', 'none');
    });
    $(window).scroll(function(){
      ta.css("top",Math.max(140,320-$(this).scrollTop()));
    });
  };
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<a href="#" class="overlay" id="qrcode"></a>',
  '<div class="qrcode clearfix"><span>扫描二维码分享到微信朋友圈</span><a class="qrclose" href="#nothing"></a><strong>Loading...Please wait</strong><img id="qrcode-pic" data-src="http://s.jiathis.com/qrcode.php?url=' + encodedUrl + '"/></div>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);
  $('.article-share-qrcode').click(function(){
    var imgSrc = $('#qrcode-pic').attr('data-src');
    $('#qrcode-pic').attr('src', imgSrc);
    $('#qrcode-pic').load(function(){
        $('.qrcode strong').text(' ');
    });
  });
});     
</script>



<script type="text/javascript">
  var duoshuoQuery = {short_name:"qiaoidea"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 







<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->





<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

  </body>
</html>
